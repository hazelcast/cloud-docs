= C# Hello World
:url-github-net: http://hazelcast.github.io/hazelcast-csharp-client/dev/doc/configuration.html
:description: This tutorial shows you how to get started with Hazelcast Cloud quickly. You'll create a Hazelcast Serverless cluster, and then use the C# client to add some entries to a map.

{description}

== Before you Begin

You need a xref:create-account.adoc[Hazelcast Cloud account].

== Step 1. Start a Hazelcast Cloud Cluster

In the Hazelcast Cloud console, do the following:

include::create-cluster.adoc[tags=serverless;serverless-sandbox] 

== Step 2. Run the Sample Client

. Open the Hazelcast Cloud console and click *Connect your Application*.

. Go to the *.Net* tab and download the ZIP file.

. Extract the ZIP file, change into the extracted root directory and execute the following command:
+
```bash
dotnet run --project ClientWithSsl
```

You should see log output similar to the following:

image:net-client-log.png[.Net client logs that it is connected]

`Connection Successful!` in your logs means that your client application has successfully connected to your cluster in Hazelcast Cloud. The sample client code adds random entries to a map in your cluster. In your Hazelcast Cloud console, you should see the charts begin to be populated with metrics of your map.

Also, you can see your client listed under *Client Statistics* at the bottom of your cluster's page.

== Client Code

To help you understand how the client connected to the cluster, this section explains some of the source code. 

TIP: The code for this sample client is hosted on link:https://github.com/hazelcast/hazelcast-cloud-nodejs-sample-client/tree/5.1/client_with_ssl.js[GitHub].

=== Client/Program.cs

This is the downloaded sample client code when your cluster does not have an encryption.

[source,cs]
----
using System;
using System.Threading;
using Hazelcast.Client;
using Hazelcast.Config;

 namespace Client
 {
  class Program
  {
    public static void Main(string[] args)
    {
      Environment.SetEnvironmentVariable("hazelcast.client.cloud.url", "YOUR_DISCOVERY_URL");
      var config = new ClientConfig(); // <1>
      // <2>
      config.GetGroupConfig()
          .SetName("YOUR_CLUSTER_NAME")
          .SetPassword("YOUR_CLUSTER_PASSWORD");
      // <3>
      config.GetNetworkConfig().GetCloudConfig()
          .SetEnabled(true)
          .SetDiscoveryToken("YOUR_CLUSTER_DISCOVERY_TOKEN");

      var client = HazelcastClient.NewHazelcastClient(config); // <4>
      // <5>
      var map = client.GetMap<string, string>("map");
      map.Put("key", "value");
      // <6>
      if(map.Get("key").Equals("value"))
      {
        Console.WriteLine("Connection Successful!");
        Console.WriteLine("Now, `map` will be filled with random entries.");
      }
      else {
        throw new Exception("Connection failed, check your configuration.");
      }
      var random = new Random();
      while (true) {
        var randomKey = random.Next(100_000);
        map.Put("key" + randomKey, "value" + randomKey);
        map.Get("key" + random.Next(100_000));
        if(randomKey % 10 == 0 )
        {
          Console.WriteLine("map size: {0}", map.Size());
        }
        Thread.Sleep(100);
      }
    }
  }
}
----

<1> First, we create an empty client configuration.

<2> Then, we set the cluster name and password via `GroupConfig`.
+
The cluster name and password are unique to your cluster. The client is authenticated using this password.

<3> We enable the cloud configuration and set the discovery token.
+
The discovery token is also unique to your cluster and is used to discover Hazelcast cluster members.

<4> Now, we create the client with `config`.
+
This step creates the connection between your application and the cluster.

<5> We get/create a map and put a simple entry ("key", "value").

<6> Then, we check if the entry has been added and let the code throw an exception if the value is not correct. Finally, we add random entries with 100-millisecond intervals.

.ClientWithSsl/Program.cs
[source,cs]
----
using System;
using System.Security.Authentication;
using System.Threading.Tasks;
using Hazelcast;
using Hazelcast.Networking;
using Microsoft.Extensions.Logging;

namespace ClientWithSsl
{
  internal static class Program
  {
    private const int IterationCount = 100;

    public static async Task Main(string[] args)
    {
      Console.WriteLine();
      Console.WriteLine("Hazelcast Cloud Client with SSL");

      Console.Write("Build options...");
      var options = new HazelcastOptionsBuilder()
        .With(args)
        .WithConsoleLogger()
        .With("Logging:LogLevel:Hazelcast", "Information")
        .Build();

      // log level must be a valid Microsoft.Extensions.Logging.LogLevel value
      //   Trace | Debug | Information | Warning | Error | Critical | None

      if (args.Length == 0)
      {
        // it is OK to pass the arguments in the command line
        // otherwise, they must be specified here

        options.ClusterName = "YOUR-CLUSTER-NAME"; <1>

        options.Networking.Cloud.DiscoveryToken = "YOUR_CLUSTER_DISCOVERY_TOKEN"; <2>
      }

      // make sure the client stays connected
      options.Networking.ReconnectMode = ReconnectMode.ReconnectAsync;
      
      options.Metrics.Enabled = true; <3>

      <4>
      options.Networking.Ssl.Enabled = true;
      options.Networking.Ssl.ValidateCertificateChain = false;
      options.Networking.Ssl.Protocol = SslProtocols.Tls12;
      options.Networking.Ssl.CertificatePath = "client.pfx";
      options.Networking.Ssl.CertificatePassword = "YOUR_KEYSTORE_PASSWORD";

      Console.WriteLine(" ok.");

      Console.Write("Get and connect client...");
      await using var client = await HazelcastClientFactory.StartNewClientAsync(options);
      Console.WriteLine(" ok.");

      Console.Write("Get map...");
      await using var map = await client.GetMapAsync<string, string>("map");
      Console.WriteLine(" ok.");

      Console.Write("Put value into map...");
      await map.PutAsync("key", "value");
      Console.WriteLine(" ok.");

      Console.Write("Get value from map...");
      var value = await map.GetAsync("key");
      Console.WriteLine(" ok");

      Console.Write("Validate value...");
      if (value.Equals("value"))
      {
        Console.WriteLine("ok.");
      }
      else
      {
        Console.WriteLine("Error.");
        Console.WriteLine("Check your configuration.");
        return;
      }

      <5>
      Console.WriteLine("Put/Get values in/from map with random values...");
      var random = new Random();
      var step = IterationCount / 10;
      for (var i = 0; i < IterationCount; i++)
      {
        var randomValue = random.Next(100_000);
        await map.PutAsync("key_" + randomValue, "value_" + randomValue);

        randomValue = random.Next(100_000);
        await map.GetAsync("key" + randomValue);

        if (i % step == 0)
        {
          Console.WriteLine($"[{i:D3}] map size: {await map.GetSizeAsync()}");
        }
      }

    Console.WriteLine("Done.");
  }

  public static HazelcastOptionsBuilder WithConsoleLogger(this HazelcastOptionsBuilder builder)
  {
    return builder
      .With("Logging:LogLevel:Default", "None")
      .With("Logging:LogLevel:System", "None")
      .With("Logging:LogLevel:Microsoft", "None")
      .With((configuration, options) =>
      {
        // configure logging factory and add the console provider
        options.LoggerFactory.Creator = () => LoggerFactory.Create(loggingBuilder =>
          loggingBuilder
            .AddConfiguration(configuration.GetSection("logging"))
            .AddConsole());
      });
    }
  }
}
----

<1> Set the cluster name.
+
The cluster name is unique to your cluster. The client is authenticated using this cluster name.

<2> Set the discovery token.
+
This token is also unique to your cluster and used to discover Hazelcast cluster members.

<3> Enable Hazelcast to send the client statistics to the cluster's page.

<4> Configure TLS encryption. You already downloaded these certificate and key files with the client code. 

<5> Add random entries with 100-millisecond intervals. 

== Learn More

See the link:{url-github-net}[Hazelcast C# client documentation] for more information about using the C# client.